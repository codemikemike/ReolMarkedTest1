<Window
    x:Class="ReolMarked.MVVM.Views.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="Middelby Reolmarked - Reol Administration"
    Width="1400"
    Height="900"
    Background="#F5F5F5"
    WindowStartupLocation="CenterScreen">

    <!--  Main Grid Layout  -->
    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <!--  Header område  -->
        <Border
            Grid.Row="0"
            Margin="0,0,0,10"
            Background="#2E5BBA">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>

                <StackPanel
                    Grid.Column="0"
                    Margin="20,15"
                    Orientation="Vertical">
                    <TextBlock
                        FontSize="24"
                        FontWeight="Bold"
                        Foreground="White"
                        Text="Middelby Reolmarked" />
                    <TextBlock
                        FontSize="14"
                        Foreground="LightBlue"
                        Text="Reol Administration System - UC1 &amp; UC2" />
                </StackPanel>

                <StackPanel
                    Grid.Column="1"
                    Margin="20,15"
                    Orientation="Horizontal">
                    <Button
                        Margin="5,0"
                        Padding="15,8"
                        Background="#4CAF50"
                        BorderThickness="0"
                        Command="{Binding ShowAvailableRacksCommand}"
                        Content="Vis Alle Ledige Reoler"
                        Foreground="White" />

                    <Button
                        Margin="5,0"
                        Padding="15,8"
                        Background="#FF9800"
                        BorderThickness="0"
                        Command="{Binding ShowRacksWithoutHangerBarCommand}"
                        Content="Kun Reoler Uden Bøjlestang"
                        Foreground="White" />

                    <!--  NYT - UC2 knap  -->
                    <Button
                        Margin="5,0"
                        Padding="15,8"
                        Background="#03A9F4"
                        BorderThickness="0"
                        Command="{Binding ShowNeighborRacksCommand}"
                        Content="Vis Nabo-Reoler"
                        Foreground="White"
                        IsEnabled="{Binding IsCustomerSelected}" />

                    <!--  Knap til seperat window for BARCODE - stregkode  -->
                    <Button
                        Margin="5,0"
                        Padding="15,8"
                        Background="#9C27B0"
                        BorderThickness="0"
                        Click="OpenBarcodeWindow_Click"
                        Content="Opret Stregkoder"
                        Foreground="White" />

                    <!--  NY - UC3.1 knap - seperat window  -->
                    <Button
                        Margin="5,0"
                        Padding="15,8"
                        Background="#E91E63"
                        BorderThickness="0"
                        Click="OpenScannerWindow_Click"
                        Content="Åbn Scanner Kasse"
                        Foreground="White" />
                    <!--  NY - UC4.1 knap - seperat window  -->
                    <Button
                        Margin="5,0"
                        Padding="15,8"
                        Background="#795548"
                        BorderThickness="0"
                        Click="OpenFakturaWindow_Click"
                        Content="Månedlig Afregning"
                        Foreground="White" />

                    <!--  NY - UC5.1 knap - separat window  -->
                    <Button
                        Margin="5,0"
                        Padding="15,8"
                        Background="#F44336"
                        BorderThickness="0"
                        Click="OpenTerminationWindow_Click"
                        Content="Opsig Reoler"
                        Foreground="White" />
                </StackPanel>
            </Grid>
        </Border>

        <!--  Main Content  -->
        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="2*" />
                <ColumnDefinition Width="10" />
                <ColumnDefinition Width="1*" />
            </Grid.ColumnDefinitions>

            <!--  Venstre side - Reol oversigt  -->
            <Border
                Grid.Column="0"
                Background="White"
                BorderBrush="#E0E0E0"
                BorderThickness="1">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>

                    <!--  Reol liste header  -->
                    <Border
                        Grid.Row="0"
                        Padding="15,10"
                        Background="#F8F9FA">
                        <TextBlock
                            FontSize="18"
                            FontWeight="SemiBold"
                            Foreground="#333"
                            Text="Ledige Reoler" />
                    </Border>

                    <!--  Reol liste  -->
                    <ListBox
                        Grid.Row="1"
                        Margin="10"
                        Background="Transparent"
                        BorderThickness="0"
                        ItemsSource="{Binding AvailableRacks}"
                        SelectedItem="{Binding SelectedRack}">

                        <ListBox.ItemTemplate>
                            <DataTemplate>
                                <Border
                                    Margin="5"
                                    Padding="15"
                                    Background="White"
                                    BorderBrush="#E0E0E0"
                                    BorderThickness="1">

                                    <Border.Style>
                                        <Style TargetType="Border">
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding IsSelected, RelativeSource={RelativeSource AncestorType=ListBoxItem}}" Value="True">
                                                    <Setter Property="Background" Value="#E3F2FD" />
                                                    <Setter Property="BorderBrush" Value="#2196F3" />
                                                    <Setter Property="BorderThickness" Value="2" />
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Border.Style>

                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>

                                        <!--  Reol nummer (stor)  -->
                                        <Border
                                            Grid.Column="0"
                                            Width="50"
                                            Height="50"
                                            VerticalAlignment="Center"
                                            Background="#2E5BBA">
                                            <TextBlock
                                                HorizontalAlignment="Center"
                                                VerticalAlignment="Center"
                                                FontSize="20"
                                                FontWeight="Bold"
                                                Foreground="White"
                                                Text="{Binding RackNumber}" />
                                        </Border>

                                        <!--  Reol info  -->
                                        <StackPanel
                                            Grid.Column="1"
                                            Margin="15,0,10,0"
                                            VerticalAlignment="Center">
                                            <TextBlock
                                                FontSize="14"
                                                FontWeight="SemiBold"
                                                Foreground="#333"
                                                Text="{Binding RackType}" />
                                            <TextBlock
                                                Margin="0,2,0,0"
                                                FontSize="12"
                                                Foreground="#666"
                                                Text="{Binding Location}" />
                                            <TextBlock
                                                Margin="0,2,0,0"
                                                FontSize="11"
                                                Foreground="#999"
                                                Text="{Binding Description}" />
                                        </StackPanel>

                                        <!--  Status  -->
                                        <Border
                                            Grid.Column="2"
                                            Padding="8,4"
                                            VerticalAlignment="Center"
                                            Background="#4CAF50">
                                            <TextBlock
                                                FontSize="10"
                                                FontWeight="Bold"
                                                Foreground="White"
                                                Text="{Binding StatusText}" />
                                        </Border>
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </ListBox.ItemTemplate>
                    </ListBox>
                </Grid>
            </Border>

            <!--  Splitter  -->
            <GridSplitter
                Grid.Column="1"
                Width="2"
                HorizontalAlignment="Stretch"
                Background="#E0E0E0" />

            <!--  Højre side - Kunde håndtering  -->
            <Grid Grid.Column="2">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <!--  NYT - Kundens reoler  -->
                    <RowDefinition Height="Auto" />
                    <!--  NYT - Nabo-reoler  -->
                    <RowDefinition Height="*" />
                    <!--  Ny kunde formular  -->
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>

                <!--  Valgt reol info  -->
                <Border
                    Grid.Row="0"
                    Margin="0,0,0,10"
                    Background="White"
                    BorderBrush="#E0E0E0"
                    BorderThickness="1">

                    <StackPanel Margin="15">
                        <TextBlock
                            Margin="0,0,0,5"
                            FontSize="14"
                            FontWeight="SemiBold"
                            Foreground="#333"
                            Text="Valgt Reol:" />

                        <TextBlock
                            FontSize="12"
                            Foreground="#666"
                            Text="{Binding SelectedRack.RackNumber, StringFormat='Reol nummer: {0}'}"
                            Visibility="{Binding IsRackSelected}" />

                        <TextBlock
                            FontSize="12"
                            Foreground="#666"
                            Text="{Binding SelectedRack.RackType}"
                            Visibility="{Binding IsRackSelected}" />

                        <TextBlock
                            FontSize="12"
                            Foreground="#666"
                            Text="{Binding SelectedRack.Location}"
                            Visibility="{Binding IsRackSelected}" />

                        <TextBlock
                            FontSize="12"
                            FontStyle="Italic"
                            Foreground="#999"
                            Text="Ingen reol valgt">
                            <TextBlock.Style>
                                <Style TargetType="TextBlock">
                                    <Setter Property="Visibility" Value="Collapsed" />
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding IsRackSelected}" Value="False">
                                            <Setter Property="Visibility" Value="Visible" />
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </TextBlock.Style>
                        </TextBlock>
                    </StackPanel>
                </Border>

                <!--  Kunde valg  -->
                <Border
                    Grid.Row="1"
                    Margin="0,0,0,10"
                    Background="White"
                    BorderBrush="#E0E0E0"
                    BorderThickness="1">

                    <StackPanel Margin="15">
                        <TextBlock
                            Margin="0,0,0,5"
                            FontSize="14"
                            FontWeight="SemiBold"
                            Foreground="#333"
                            Text="Vælg Eksisterende Kunde:" />

                        <ComboBox
                            Height="30"
                            Margin="0,5"
                            DisplayMemberPath="DisplayText"
                            ItemsSource="{Binding Customers}"
                            SelectedItem="{Binding SelectedCustomer}" />
                    </StackPanel>
                </Border>

                <!--  NYT - UC2: Kundens eksisterende reoler  -->
                <Border
                    Grid.Row="2"
                    Margin="0,0,0,10"
                    Background="White"
                    BorderBrush="#E0E0E0"
                    BorderThickness="1">

                    <StackPanel Margin="15">
                        <TextBlock
                            Margin="0,0,0,5"
                            FontSize="14"
                            FontWeight="SemiBold"
                            Foreground="#333"
                            Text="Kundens Nuværende Reoler:" />

                        <ListBox
                            Height="100"
                            Background="Transparent"
                            BorderThickness="0"
                            ItemsSource="{Binding CustomerRacks}"
                            SelectedItem="{Binding SelectedCustomerRack}">

                            <ListBox.Style>
                                <Style TargetType="ListBox">
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding CustomerRacks.Count}" Value="0">
                                            <Setter Property="Visibility" Value="Collapsed" />
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </ListBox.Style>

                            <ListBox.ItemTemplate>
                                <DataTemplate>
                                    <Border
                                        Margin="2"
                                        Padding="8,4"
                                        Background="#F0F8FF"
                                        BorderBrush="#4169E1"
                                        BorderThickness="1">

                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock
                                                FontSize="12"
                                                FontWeight="SemiBold"
                                                Text="{Binding RackNumber, StringFormat='Reol {0}'}" />
                                            <TextBlock
                                                Margin="10,0,0,0"
                                                FontSize="10"
                                                Foreground="#666"
                                                Text="{Binding Location}" />
                                        </StackPanel>
                                    </Border>
                                </DataTemplate>
                            </ListBox.ItemTemplate>
                        </ListBox>

                        <TextBlock
                            FontSize="12"
                            FontStyle="Italic"
                            Foreground="#999"
                            Text="Kunden har ingen reoler endnu">
                            <TextBlock.Style>
                                <Style TargetType="TextBlock">
                                    <Setter Property="Visibility" Value="Collapsed" />
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding CustomerRacks.Count}" Value="0">
                                            <Setter Property="Visibility" Value="Visible" />
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </TextBlock.Style>
                        </TextBlock>
                    </StackPanel>
                </Border>

                <!--  NYT - UC2: Nabo-reoler  -->
                <Border
                    Grid.Row="3"
                    Margin="0,0,0,10"
                    Background="White"
                    BorderBrush="#E0E0E0"
                    BorderThickness="1">

                    <StackPanel Margin="15">
                        <TextBlock
                            Margin="0,0,0,5"
                            FontSize="14"
                            FontWeight="SemiBold"
                            Foreground="#333"
                            Text="Ledige Nabo-Reoler:" />

                        <ListBox
                            Height="80"
                            Background="Transparent"
                            BorderThickness="0"
                            ItemsSource="{Binding NeighborRacks}">

                            <ListBox.Style>
                                <Style TargetType="ListBox">
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding NeighborRacks.Count}" Value="0">
                                            <Setter Property="Visibility" Value="Collapsed" />
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </ListBox.Style>

                            <ListBox.ItemTemplate>
                                <DataTemplate>
                                    <Border
                                        Margin="2"
                                        Padding="8,4"
                                        Background="#E8F5E8"
                                        BorderBrush="#4CAF50"
                                        BorderThickness="1">

                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock
                                                FontSize="12"
                                                FontWeight="SemiBold"
                                                Text="{Binding RackNumber, StringFormat='Reol {0}'}" />
                                            <TextBlock
                                                Margin="10,0,0,0"
                                                FontSize="10"
                                                FontWeight="Bold"
                                                Foreground="#4CAF50"
                                                Text="LEDIG" />
                                        </StackPanel>
                                    </Border>
                                </DataTemplate>
                            </ListBox.ItemTemplate>
                        </ListBox>

                        <TextBlock
                            FontSize="12"
                            FontStyle="Italic"
                            Foreground="#999"
                            Text="Ingen nabo-reoler til rådighed">
                            <TextBlock.Style>
                                <Style TargetType="TextBlock">
                                    <Setter Property="Visibility" Value="Collapsed" />
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding NeighborRacks.Count}" Value="0">
                                            <Setter Property="Visibility" Value="Visible" />
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </TextBlock.Style>
                        </TextBlock>
                    </StackPanel>
                </Border>

                <!--  Ny kunde formular  -->
                <Border
                    Grid.Row="4"
                    Margin="0,0,0,10"
                    Background="White"
                    BorderBrush="#E0E0E0"
                    BorderThickness="1">

                    <ScrollViewer VerticalScrollBarVisibility="Auto">
                        <StackPanel Margin="15">
                            <TextBlock
                                Margin="0,0,0,10"
                                FontSize="14"
                                FontWeight="SemiBold"
                                Foreground="#333"
                                Text="Opret Ny Kunde:" />

                            <!--  Kunde navn  -->
                            <TextBlock
                                Margin="0,5,0,2"
                                FontSize="12"
                                Foreground="#666"
                                Text="Fulde navn:" />
                            <TextBox
                                Height="30"
                                Padding="8,5"
                                BorderBrush="#E0E0E0"
                                Text="{Binding NewCustomerName, UpdateSourceTrigger=PropertyChanged}" />

                            <!--  Telefon  -->
                            <TextBlock
                                Margin="0,10,0,2"
                                FontSize="12"
                                Foreground="#666"
                                Text="Telefonnummer:" />
                            <TextBox
                                Height="30"
                                Padding="8,5"
                                BorderBrush="#E0E0E0"
                                Text="{Binding NewCustomerPhone, UpdateSourceTrigger=PropertyChanged}" />

                            <!--  Email  -->
                            <TextBlock
                                Margin="0,10,0,2"
                                FontSize="12"
                                Foreground="#666"
                                Text="Email:" />
                            <TextBox
                                Height="30"
                                Padding="8,5"
                                BorderBrush="#E0E0E0"
                                Text="{Binding NewCustomerEmail, UpdateSourceTrigger=PropertyChanged}" />

                            <!--  Adresse  -->
                            <TextBlock
                                Margin="0,10,0,2"
                                FontSize="12"
                                Foreground="#666"
                                Text="Adresse:" />
                            <TextBox
                                Height="60"
                                Padding="8,5"
                                AcceptsReturn="True"
                                BorderBrush="#E0E0E0"
                                Text="{Binding NewCustomerAddress, UpdateSourceTrigger=PropertyChanged}"
                                TextWrapping="Wrap"
                                VerticalScrollBarVisibility="Auto" />

                            <!--  Opret kunde knap  -->
                            <Button
                                Height="35"
                                Margin="0,15,0,0"
                                Background="#4CAF50"
                                BorderThickness="0"
                                Command="{Binding CreateCustomerCommand}"
                                Content="Opret Kunde"
                                FontWeight="SemiBold"
                                Foreground="White" />
                        </StackPanel>
                    </ScrollViewer>
                </Border>

                <!--  Handlingsknapper  -->
                <StackPanel Grid.Row="5" Orientation="Vertical">
                    <!--  Opret kontrakt knap  -->
                    <Button
                        Height="40"
                        Margin="0,5"
                        Background="#2E5BBA"
                        BorderThickness="0"
                        Command="{Binding CreateContractCommand}"
                        Content="Opret Reol Lejeaftale"
                        FontSize="14"
                        FontWeight="SemiBold"
                        Foreground="White"
                        IsEnabled="{Binding CanCreateContract}" />

                    <!--  Ryd valg knap  -->
                    <Button
                        Height="35"
                        Margin="0,5"
                        Background="#F44336"
                        BorderThickness="0"
                        Command="{Binding ClearSelectionCommand}"
                        Content="Ryd Valg"
                        Foreground="White" />
                </StackPanel>
            </Grid>
        </Grid>

        <!--  Footer - Status bar  -->
        <Border
            Grid.Row="2"
            Margin="0,10,0,0"
            Padding="15,8"
            Background="#37474F">

            <TextBlock
                VerticalAlignment="Center"
                FontSize="12"
                Foreground="White"
                Text="{Binding StatusMessage}" />
        </Border>
    </Grid>
</Window>